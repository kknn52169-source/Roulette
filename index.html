<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title> روليت</title>
<style>
body {
  font-family: Tahoma, sans-serif;
  background: #0f172a;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  margin: 0;
  padding: 20px;
}
h1 { margin-bottom: 20px; text-align: center; }
input, button {
  font-size: 16px;
  padding: 6px 10px;
  margin: 5px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}
.wheel-container {
  position: relative;
  width: 300px;
  height: 300px;
  margin-top: 20px;
}
.wheel {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 8px solid #22d3ee;
  overflow: hidden;
  position: relative;
  transform: rotate(0deg);
}
.segment {
  position: absolute;
  width: 50%;
  height: 50%;
  top: 50%;
  left: 50%;
  transform-origin: 0% 0%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: bold;
  text-align: center;
  font-size: 16px;
  border-radius: 6px;
  transition: background-color 0.3s;
}
.pointer {
  position: absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 12px solid transparent;
  border-right: 12px solid transparent;
  border-bottom: 20px solid #ef4444;
}
#nameListDiv {
  margin-top: 20px;
  display: flex;
  flex-direction: column;
  gap: 5px;
  width: 300px;
}
.nameItem {
  display: flex;
  justify-content: space-between;
  background: #1f2937;
  padding: 6px 10px;
  border-radius: 6px;
}
.nameItem button {
  background: #ef4444;
  color: #fff;
  font-weight: bold;
}
</style>
</head>
<body>

<h1>🎡 روليت </h1>

<div>
  <input type="text" id="nameInput" placeholder="اكتب اسم">
  <button id="addBtn">إضافة</button>
</div>
<button id="spinBtn">تدوير العجلة</button>
<h4> تواصل @mmmmx9 </h4>
<div class="wheel-container">
  <div class="pointer"></div>
  <div class="wheel" id="wheel"></div>
</div>

<div id="nameListDiv"></div>

<script>
const wheel = document.getElementById('wheel');
const spinBtn = document.getElementById('spinBtn');
const addBtn = document.getElementById('addBtn');
const nameInput = document.getElementById('nameInput');
const nameListDiv = document.getElementById('nameListDiv');

let namesList = [];
let colorInterval = null;
let currentRotation = 0;

// لون عشوائي
function randomColor() {
  const r = Math.floor(Math.random()*256);
  const g = Math.floor(Math.random()*256);
  const b = Math.floor(Math.random()*256);
  return `rgb(${r},${g},${b})`;
}

// رسم العجلة
function drawWheel(){
  wheel.innerHTML = '';
  const total = namesList.length;
  namesList.forEach((name,i)=>{
    const seg = document.createElement('div');
    seg.classList.add('segment');
    const angle = 360 / total * i;
    seg.style.transform = `rotate(${angle}deg) translate(0, -100%)`;
    seg.textContent = name;
    seg.style.backgroundColor = randomColor();
    wheel.appendChild(seg);
  });
}

// تحديث قائمة الأسماء
function updateNameListDiv(){
  nameListDiv.innerHTML = '';
  namesList.forEach((name,i)=>{
    const div = document.createElement('div');
    div.classList.add('nameItem');
    div.innerHTML = `<span>${name}</span> <button onclick="removeName(${i})">مسح</button>`;
    nameListDiv.appendChild(div);
  });
}

// حذف اسم
function removeName(index){
  namesList.splice(index,1);
  drawWheel();
  updateNameListDiv();
}

// ألوان متحركة أثناء الدوران
function startColors(){
  if(colorInterval) clearInterval(colorInterval);
  colorInterval = setInterval(()=>{
    const segments = document.querySelectorAll('.segment');
    segments.forEach(seg=>{
      seg.style.backgroundColor = randomColor();
    });
  },200);
}

function stopColors(){
  if(colorInterval) clearInterval(colorInterval);
}

// إضافة اسم
addBtn.addEventListener('click', ()=>{
  const name = nameInput.value.trim();
  if(name){
    namesList.push(name);
    nameInput.value = '';
    drawWheel();
    updateNameListDiv();
  }
});

// تدوير العجلة لمدة 10 ثواني والفائز تحت المؤشر
spinBtn.addEventListener('click', ()=>{
  if(namesList.length===0){
    alert('لا يوجد أسماء!');
    return;
  }

  const spins = Math.floor(Math.random()*5)+10; // عدد لفات
  const winnerIndex = Math.floor(Math.random()*namesList.length); // الفائز عشوائي
  const segmentAngle = 360 / namesList.length;

  // الدوران بحيث يصبح الاسم الفائز تحت المؤشر
  const stopAngle = 360 - (winnerIndex * segmentAngle + segmentAngle/2);

  const rotation = spins*360 + stopAngle;

  wheel.style.transition = 'transform 10s cubic-bezier(0.33, 1, 0.68, 1)';
  wheel.style.transform = `rotate(${rotation}deg)`;
  spinBtn.disabled = true;

  startColors();

  setTimeout(()=>{
    currentRotation = rotation % 360;
    wheel.style.transition = 'none';
    wheel.style.transform = `rotate(${currentRotation}deg)`;
    spinBtn.disabled = false;
    stopColors();
    alert('الفائز هو: '+namesList[winnerIndex]);
  },10000);
});
</script>

</body>
</html>